<!DOCTYPE html>
<!-- custom -->
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
    <head>
        <link rel="stylesheet" type="text/css" href="css/public_settings.css">
    </head>

<div th:insert="~{/header :: commonFragment}"></div>
<style>
    .noneline {text-decoration: none;}
</style>
<!-- Navigation-->
<div th:insert="~{/header :: navFragment}"></div>
    <body class="d-flex flex-column min-vh-100">


<section class="page-section public-settings" id="services">
    <div class="container" style="margin-bottom:60px;">
        <!-- For demo purpose -->
        <div class="row py-5">
            <div class="col-lg-9 mx-auto text-white text-center" style="margin-left:300px;">
                <h1 class="display-4" style="color:black !important; margin-left:20px;">레시피</h1>
            </div>
        </div>

        <!--탭바-->
        <div class="container text-center">
            <!-- Nav tabs -->
            <ul class="nav nav-tabs justify-content-center" id="recipeTabs">
                <!-- Iterate over uniqueRecipeTypes and create tabs -->
                <li th:each="recipeType : ${RecipeTypes}" class="nav-item">
                    <a th:href="'#tab_' + ${recipeType}" th:text="${recipeType}" class="nav-link" data-toggle="tab"></a>
                </li>
            </ul>

            <!-- Tab panes -->
            <div class="tab-content">
                <!-- Iterate over uniqueRecipeTypes and create tab panes -->
                <div th:each="recipeType : ${RecipeTypes}" th:id="'tab_' + ${recipeType}" class="tab-pane fade">
                    <!-- Content for each tab goes here -->
                    <h3 th:text="'Content for ' + ${recipeType}"></h3>
                    <div id="recipesContainer"></div>
                </div>
            </div>
        </div>

        <script th:inline="javascript">
    $(document).ready(function() {
        // Initial load of the first tab
        loadRecipes('${RecipeTypes[0]}');

        // Handle tab clicks
        $('#recipeTabs a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
            var recipeType = $(e.target).text();
            loadRecipes(recipeType);
        });

        function loadRecipes(recipeType) {
            // Ajax request to load recipes for the selected recipeType
            $.get('/recipes?recipeType=' + recipeType, function(data) {
                // Update recipesContainer with the received data
                $('#' + 'tab_' + recipeType + ' #recipesContainer').html(data);
            });
        }
    });
</script>



        <!--목록-->
            <div class="container">
                <div th:if="${#lists.isEmpty(recipeData)}">
                    <p>데이터가 없습니다.</p>
                </div>
            </div>

            <div class="container" th:unless="${#lists.isEmpty(recipeData)}">
                <div class="row row justify-content-md-center text-center">
                    <div class="col p-2" th:each="recipeItem : ${recipeData}">

                        <div class="card " style="width: 18rem;">
                            <a class="noneline text-success" th:href="@{/recipeDetail(recipeno=${recipeItem.recipe_no})}">
                                <img th:if="${not #strings.isEmpty(recipeItem.recipe_img)}"
                                     th:src="@{/img/recipe/{recipe_img}(recipe_img=${recipeItem.recipe_img})}"
                                     class="card-img-top " alt="레시피 이미지입니다"
                                     style="width: 100%; height: 250px;">
                                <img th:unless="${not #strings.isEmpty(recipeItem.recipe_img)}"
                                     src="/img/notimg.jpg"
                                     class="card-img-top"
                                     alt="레시피 이미지가 없습니다"
                                     style="width: 100%; height: 250px;">
                                <div class="card-body">
                                    <h5 class="card-title" th:text="${recipeItem.recipe_name}"></h5>
                                </div>
                            </a>
                        </div>

                    </div>


                </div>
            </div>


        </div>
        <div class="d-flex justify-content-end">
            <a class="btn btn-primary" href="/recipeWrite" role="button">레시피 작성</a>
        </div>


    <div th:if="${paging.totalPages > 1}">
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center">

                <!-- 첫 페이지로 이동 -->
                <li th:if="${paging.hasPrevious}" class="page-item">
                    <a class="page-link" th:href="@{recipe(nowPageBtn=1)}" aria-label="First">
                        <span aria-hidden="true">&laquo;&laquo;</span>
                    </a>
                </li>

                <!-- 이전 페이지로 이동 -->
                <li th:if="${paging.hasPrevious}" class="page-item">
                    <a class="page-link" th:href="@{recipe(nowPageBtn=${paging.number - 1})}" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>

                <!-- 페이지 번호 표시 -->
                <li th:each="i : ${#numbers.sequence(paging.first, paging.last)}" class="page-item" th:classappend="${i == paging.number} ? 'active'">
                    <a class="page-link" th:href="@{recipe(nowPageBtn=${i})}" th:text="${i}"></a>
                </li>

                <!-- 다음 페이지로 이동 -->
                <li th:if="${paging.hasNext}" class="page-item">
                    <a class="page-link" th:href="@{recipe(nowPageBtn=${paging.number + 1})}" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>

                <!-- 마지막 페이지로 이동 -->
                <li th:if="${paging.hasNext}" class="page-item">
                    <a class="page-link" th:href="@{recipe(nowPageBtn=${paging.totalPages})}" aria-label="Last">
                        <span aria-hidden="true">&raquo;&raquo;</span>
                    </a>
                </li>

            </ul>
        </nav>
    </div>


</section>


<!-- Footer-->
<div th:insert="~{/footer :: footerFragment}"></div>


<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS-->
<script src="/js/main_scripts.js"></script>
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
<!-- * *                               SB Forms JS                               * *-->
<!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
<script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>


</body>
</html>